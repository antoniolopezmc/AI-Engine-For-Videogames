%--------------------------------------------------------------------
\medskip
\section{Puntos de moral}

Para implementar las condiciones de victoria del videojuego, hemos usado \textit{puntos de moral}. Cada equipo (cada base, realmente) tendrá una puntuación que inicialmente tiene valor 1 e irá aumentando o disminuyendo según distintos sucesos. Cuando hay personajes de un equipo en su base y no hay personajes del equipo contrario, los puntos de moral de esa base aumentarán hasta llegar al nivel máximo. Cuando hay personajes de un equipo en la base contraria y no hay ningún personaje del otro equipo en esa misma base (es decir, la base no está protegida por personajes de ese equipo), los puntos de moral de esa base decrecerán hasta llegar a 0. Ganará el equipo que consiga reducir la moral de la base contraria a 0. También puede darse el caso de que simultáneamente los puntos de moral de ambas bases lleguen a 0. En ese caso, se producirá un empate. \\

En la clase \texttt{MoralPoints} del paquete \texttt{com.mygdx.iadevproject.checksAndActions} podemos encontrar los siguientes elementos:
\begin{itemize}
	\item Atributo \texttt{moralPointsByDefault} $\rightarrow$ Indica la cantidad máxima de puntos de moral que pueden tener los equipos.
	\item Atributo \texttt{moralPointsSubtractedByCharacter} $\rightarrow$ Indica la cantidad de puntos de moral que cada personaje sustrae de la base enemiga.
	\item Atributo \texttt{moralPointsAddedByCharacter} $\rightarrow$ Indica la cantidad de puntos de moral que cada personaje añade a su propia base. Este valor debe se rsiempre mayor que el de arriba.
	\item Atributo \texttt{moralPoints\_base\_X} $\rightarrow$ Cantidad actual de puntos de moral de un equipo determinado. Al principio de la partida, ambos equipos tiene 1 punto de moral (que se irá incrementando hasta llegar a nivel máximo).
	\item Métodos para añadir, reducir y resetear los puntos de moral del equipo de un determinado personaje (se pasa como parámetro).
	\item Método para mostrar/dibujar los puntos de moral en cada una de las bases.
\end{itemize}

En el método \texttt{haveIWin} de la clase \texttt{Checks} se comprueba, precisamente, si la base del equipo contrario del personaje que se le pasa como parámetro ha llegado a 0 puntos de moral. En caso afirmativo, el equipo correspondiente al personaje pasado como parámetro ganará la partida. Cuando en el árbol de decisión de los personajes ofensivos llegamos al nodo \texttt{Win} (porque el check haveIWin ha devuelto true), lo que hacemos es modificar un flag que se encuentra en la clase principal \texttt{IADeVProject} (una variable global). Ese flag se usará para comprobar si un equipo ha ganado y parar el juego. \\

Tal y como hemos dicho antes, la moral de una base subirá si hay personajes de ese equipo y no hay personajes del equipo contrario. Para conseguir esto, el método \texttt{addMoralPointsToMyBase} es llamado en el estado \texttt{patrolMyBase} (en la clase \texttt{DefensiveSoldier}). En ese estado solamente nos encontramos cuando patrullamos nuestra base (porque no hay enemigos cerca). Cuando un enemigo se acerque a mi base, cambiaremos de estado (para atacar a ese enemigo) y, por tanto, ya no se seguirán incrementado los puntos de moral de la base. \\

Del mismo modo, tal y como hemos dicho antes, la moral de un base bajará si hay personajes de un equipo en la base contraria y no hay ningún personaje del otro equipo en esa misma base (la base está desprotegida). Para conseguir esto, el método \texttt{subtractMoralPointsToEnemyBase} es llamado en el método \texttt{amIInEnemyBase} de la clase \texttt{Checks}. Cuando hacemos esta comprobación ya estamos seguros de que no hay enemigos cerca, ya que la comprobación de si hay enemigos cerca se encuentra antes en el árbol de decisión (más a la izquierda). Del mismo modo, cuando sí haya enemigos cerca (aunque también estemos en la base contraria), los atacaremos y no llegaremos a la comprobación \texttt{amIInEnemyBase}, por lo que ya no se seguirán sustrayendo puntos de moral a la base enemiga.
